<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PRIMED ADMIN DASHBOARD</title>
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap" rel="stylesheet">

<style>
body{font-family:Roboto,sans-serif;background:#eef3f9;margin:0;padding:16px;}
header{background:#0d6efd;color:white;padding:14px;border-radius:10px;display:flex;align-items:center;justify-content:space-between;}
header img{height:45px;}
.card{background:white;padding:16px;border-radius:10px;margin-top:16px;box-shadow:0 4px 12px rgba(0,0,0,.12);}
input,button{width:100%;padding:8px;margin:6px 0;border-radius:6px;border:1px solid #ccc;}
button{font-weight:600;cursor:pointer;}
.add{background:#198754;color:white;border:none;}
.delete{background:#dc3545;color:white;border:none;}
table{width:100%;border-collapse:collapse;margin-top:10px;}
th,td{border:1px solid #ddd;padding:6px;font-size:13px;}
th{background:#f1f3f5;}
.badge{background:#198754;color:white;padding:3px 8px;border-radius:12px;font-size:12px;}
</style>
</head>
<body>

<header>
  <img src="https://raw.githubusercontent.com/PRIMED-RRM/primedrrmverifier/main/PRIMED%20Logo%201.png">
  <strong>ADMIN DASHBOARD</strong>
</header>

<div class="card">
<h3>ADD TRAINEE</h3>
<input id="name" placeholder="FULL NAME">
<input id="certificate" placeholder="CERTIFICATE NUMBER">
<input id="training" placeholder="TRAINING">
<input id="venue" placeholder="VENUE">
<input id="date" type="date">
<button class="add" onclick="addTrainee()">ADD TRAINEE ✅</button>
</div>

<div class="card">
<h3>ALL TRAINEES</h3>
<table>
<thead>
<tr>
<th>#</th>
<th>NAME</th>
<th>CERTIFICATE</th>
<th>TRAINING</th>
<th>VENUE</th>
<th>DATE</th>
<th>STATUS</th>
<th>ACTION</th>
</tr>
</thead>
<tbody id="tbody"></tbody>
</table>
</div>

<script>
const API_URL="https://script.google.com/macros/s/AKfycbzhSjZI7iaDGoShqTDZ_3mK6DsH2bG0hpU1KJKnPeBpDUIBa1p-3-z6KYdMSnieIQ8/exec";

function loadTrainees(){
  fetch(API_URL+"?list=1")
  .then(r=>r.json())
  .then(data=>{
    const tb = document.getElementById("tbody");
    tb.innerHTML = "";
    if(!data.trainees || data.trainees.length===0){
      tb.innerHTML = "<tr><td colspan='8'>NO RECORDS ❌</td></tr>";
      return;
    }

    data.trainees.slice().reverse().forEach((t,i)=>{
      tb.innerHTML+=`
      <tr>
        <td>${i+1}</td>
        <td>${t.name.toUpperCase()}</td>
        <td>${t.certificate.toUpperCase()}</td>
        <td>${t.training.toUpperCase()}</td>
        <td>${t.venue.toUpperCase()}</td>
        <td>${t.date}</td>
        <td><span class="badge">VALID ✅</span></td>
        <td><button class="delete" onclick="deleteTrainee('${t.certificate}')">DELETE ❌</button></td>
      </tr>`;
    });
  });
}

function addTrainee(){
  const data={
    name:name.value.trim(),
    certificate:certificate.value.trim(),
    training:training.value.trim(),
    venue:venue.value.trim(),
    date:date.value
  };

  fetch(API_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify(data)
  })
  .then(r=>r.json())
  .then(d=>{
    if(d.success){
      alert("TRAINEE ADDED ✅");
      loadTrainees();
    } else {
      alert("ADD FAILED ❌");
    }
  });
}

function deleteTrainee(cert){
  if(!confirm("DELETE THIS TRAINEE?")) return;
  fetch(API_URL+"?delete=1&cert="+encodeURIComponent(cert))
  .then(r=>r.json())
  .then(d=>{
    if(d.success){
      loadTrainees();
    } else {
      alert("DELETE FAILED ❌");
    }
  });
}

window.onload = loadTrainees;
</script>

</body>
</html>
